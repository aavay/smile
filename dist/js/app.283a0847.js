(function(e){function t(t){for(var n,a,o=t[0],s=t[1],c=t[2],f=0,l=[];f<o.length;f++)a=o[f],Object.prototype.hasOwnProperty.call(u,a)&&u[a]&&l.push(u[a][0]),u[a]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);p&&p(t);while(l.length)l.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,a=1;a<r.length;a++){var o=r[a];0!==u[o]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={app:0},u={app:0},i=[];function o(e){return s.p+"js/"+({"page-index":"page-index","page-signup-index":"page-signup-index"}[e]||e)+"."+{"page-index":"561ce9e0","page-signup-index":"090c2d99"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r={"page-index":1,"page-signup-index":1};a[e]?t.push(a[e]):0!==a[e]&&r[e]&&t.push(a[e]=new Promise((function(t,r){for(var n="css/"+({"page-index":"page-index","page-signup-index":"page-signup-index"}[e]||e)+"."+{"page-index":"6c1764ac","page-signup-index":"4a378fcb"}[e]+".css",u=s.p+n,i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var c=i[o],f=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(f===n||f===u))return t()}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){c=l[o],f=c.getAttribute("data-href");if(f===n||f===u)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||u,i=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=n,delete a[e],p.parentNode.removeChild(p),r(i)},p.href=u;var d=document.getElementsByTagName("head")[0];d.appendChild(p)})).then((function(){a[e]=0})));var n=u[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,r){n=u[e]=[t,r]}));t.push(n[2]=i);var c,f=document.createElement("script");f.charset="utf-8",f.timeout=120,s.nc&&f.setAttribute("nonce",s.nc),f.src=o(e);var l=new Error;c=function(t){f.onerror=f.onload=null,clearTimeout(p);var r=u[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",l.name="ChunkLoadError",l.type=n,l.request=a,r[1](l)}u[e]=void 0}};var p=setTimeout((function(){c({type:"timeout",target:f})}),12e4);f.onerror=f.onload=c,document.head.appendChild(f)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],f=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var p=f;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"034f":function(e,t,r){"use strict";var n=r("85ec"),a=r.n(n);a.a},"0613":function(e,t,r){"use strict";r("a4d3"),r("e01a"),r("d28b"),r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0");var n=r("278c");Object.defineProperty(t,"__esModule",{value:!0});var a=r("9ab4"),u=a.__importDefault(r("2b0e")),i=a.__importDefault(r("2f62")),o=r("b850");u.default.use(i.default);var s=new o.store.State;t.default=new i.default.Store({state:s,mutations:{setInit:function(e,t){e.isInited=t},setUser:function(e,t){e.user=t},setGroups:function(e,t){e.groups=t},setPrivates:function(e,t){e.privates=t},addGroup:function(e,t){e.groups.push(t)},addPrivate:function(e,t){e.privates.push(t)},setChatting:function(e,t){e.chatting=t},pushMessage:function(e,t){var r=e.chatLogs.get(t.chatID);r?r.push(t):r=[t],e.chatLogs.set(t.chatID,r);var a=new Map,u=!0,i=!1,o=void 0;try{for(var s,c=e.chatLogs[Symbol.iterator]();!(u=(s=c.next()).done);u=!0){var f=n(s.value,2),l=f[0],p=f[1];a.set(l,p)}}catch(d){i=!0,o=d}finally{try{u||null==c.return||c.return()}finally{if(i)throw o}}e.chatLogs=a}},actions:{},modules:{}})},1:function(e,t){},1032:function(e,t,r){},"12e9":function(e,t,r){"use strict";r("d81d"),r("d3b7"),r("96cf");var n=r("c973");Object.defineProperty(t,"__esModule",{value:!0});var a=r("9ab4"),u=a.__importDefault(r("0613")),i=r("d153"),o=r("26f7"),s=a.__importDefault(r("1440")),c=a.__importDefault(r("afbc")),f=r("2e69"),l=function(){var e=n(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[new i.contact.Group("word","工作","work","0xaabbccdd"),new i.contact.Group("living","生活","living","0x11223344"),new i.contact.Group("entainment","娱乐","entertainment","0xaa22bb44")],r=[],e.next=4,f.shh.initWeb3();case 4:if(n=o.user.User.load(),n){e.next=8;break}return c.default.push({path:"/signup"}),e.abrupt("return",Promise.resolve());case 8:return e.abrupt("return",Promise.resolve().then((function(){return n.init()})).then((function(){u.default.commit("setUser",n),u.default.commit("setGroups",t),u.default.commit("setPrivates",r),u.default.commit("setChatting",t[0])})).then((function(){s.default.startPrivSubscribe(n.keyPair);var e=t.map((function(e){return e.topic}));return s.default.startSubscribe(e)})).then((function(){console.log("init done"),u.default.commit("setInit",!0)})).catch((function(e){console.log(e)})));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.default=l},1440:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("9ab4"),a=n.__importDefault(r("2b0e")),u=r("2e69"),i=new u.shh.Visitor;a.default.prototype.$visitor=i,t.default=i},2:function(e,t){},"26ba":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("9ab4"),a=n.__importDefault(r("2b0e")),u=n.__importDefault(r("5c96"));r("0fae"),a.default.use(u.default,{size:"mini"})},"26f7":function(e,t,r){"use strict";r("b0c0"),r("96cf");var n=r("c973"),a=r("970b"),u=r("5bc3");Object.defineProperty(t,"__esModule",{value:!0});var i=r("2e69");(function(e){var t="smile_user",r=function(){function e(t,r,n){a(this,e),this.keyPair=t,this.name=r,this.head=n,this.pubKey=""}return u(e,[{key:"fillPubKey",value:function(){var e=n(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.shh.getPubFromKeyPair(this.keyPair);case 3:t=e.sent,this.pubKey=t,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setPubKey",value:function(e){this.pubKey=e}},{key:"save",value:function(){var e=JSON.stringify(this);localStorage.setItem(t,e)}},{key:"init",value:function(){var e=n(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.shh.isKeyPairValid(this.keyPair);case 2:if(t=e.sent,t){e.next=9;break}return e.next=6,i.shh.newKeyPair();case 6:r=e.sent,this.keyPair=r,this.save();case 9:return e.next=11,this.fillPubKey();case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}],[{key:"isExist",value:function(){return null!==localStorage.getItem(t)}},{key:"load",value:function(){var r=localStorage.getItem(t);if(!r)return null;var n=JSON.parse(r),a=new e(n.keyPair,n.name,n.head);return a}}]),e}();e.User=r})(t.user||(t.user={}))},"2e69":function(e,t,r){"use strict";r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");var n=r("970b"),a=r("5bc3");r("96cf");var u=r("c973");Object.defineProperty(t,"__esModule",{value:!0});var i=r("9ab4"),o=r("6314"),s=i.__importDefault(r("0613"));(function(e){var t=new o,r=3,i=.5,c="ws://192.168.0.111:8546";e.newKeyPair=u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.shh.newKeyPair());case 1:case"end":return e.stop()}}),e)}))),e.getPubFromKeyPair=function(){var e=u(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.shh.getPublicKey(r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.initWeb3=u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.setProvider(new o.providers.WebsocketProvider(c)),e.next=3,t.eth.net.isListening();case 3:case"end":return e.stop()}}),e)}))),e.isKeyPairValid=function(){var e=u(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.shh.hasKeyPair(r);case 3:return n=e.sent,e.abrupt("return",Promise.resolve(n));case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",Promise.resolve(!1));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();var f=function(){function e(){n(this,e),this.symPasswd="apple&banana",this.symKeyID=""}return a(e,[{key:"startSubscribe",value:function(){var e=u(regeneratorRuntime.mark((function e(r){var n,a,u,i,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.shh.generateSymKeyFromPassword(this.symPasswd);case 2:for(this.symKeyID=e.sent,n=!0,a=!1,u=void 0,e.prev=6,i=r[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)s=o.value,c={symKeyID:this.symKeyID,topics:[s]},t.shh.subscribe("messages",c,this.rece);e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](6),a=!0,u=e.t0;case 14:e.prev=14,e.prev=15,n||null==i.return||i.return();case 17:if(e.prev=17,!a){e.next=20;break}throw u;case 20:return e.finish(17);case 21:return e.finish(14);case 22:case"end":return e.stop()}}),e,this,[[6,10,14,22],[15,,17,21]])})));function r(t){return e.apply(this,arguments)}return r}()},{key:"startPrivSubscribe",value:function(e){var r={privateKeyID:e};t.shh.subscribe("messages",r,this.recePriv)}},{key:"send",value:function(){var e=u(regeneratorRuntime.mark((function e(n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.shh.post({symKeyID:this.symKeyID,topic:n,payload:t.utils.utf8ToHex(JSON.stringify(a)),powTime:r,powTarget:i});case 2:e.sent;case 3:case"end":return e.stop()}}),e,this)})));function n(t,r){return e.apply(this,arguments)}return n}()},{key:"sendPriv",value:function(){var e=u(regeneratorRuntime.mark((function e(n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.shh.post({pubKey:n,payload:t.utils.utf8ToHex(JSON.stringify(a)),powTime:r,powTarget:i});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));function n(t,r){return e.apply(this,arguments)}return n}()},{key:"rece",value:function(e,r,n){if(r){var a=r.payload,u=t.utils.hexToUtf8(a),i=JSON.parse(u);s.default.commit("pushMessage",i)}}},{key:"recePriv",value:function(e,r,n){if(r){var a=r.payload,u=t.utils.hexToUtf8(a),i=JSON.parse(u);i.chatID=i.pubKey,s.default.commit("pushMessage",i)}}}]),e}();e.Visitor=f})(t.shh||(t.shh={}))},3:function(e,t){},"3dfd":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("router-view")},a=[],u=(r("034f"),r("2877")),i={},o=Object(u["a"])(i,n,a,!1,null,null,null);t["default"]=o.exports},4:function(e,t){},"6f37":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("9ab4"),a=n.__importDefault(r("2b0e")),u=n.__importDefault(r("4eb5"));u.default.config.autoSetContainer=!0,a.default.use(u.default)},"73e9":function(e,t,r){var n={"./default.vue":"7b3d"};function a(e){var t=u(e);return r(t)}function u(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=u,e.exports=a,a.id="73e9"},"7b3d":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("router-view")],1)},a=[],u=r("2877"),i={},o=Object(u["a"])(i,n,a,!1,null,null,null);t["default"]=o.exports},"85ec":function(e,t,r){},afbc:function(e,t,r){"use strict";r("d3b7"),r("96cf");var n=r("c973");Object.defineProperty(t,"__esModule",{value:!0});var a=r("9ab4"),u=a.__importDefault(r("2b0e")),i=a.__importDefault(r("8c4f")),o=a.__importDefault(r("db39")),s=r("aecd"),c=a.__importDefault(r("0613")),f=a.__importDefault(r("12e9"));u.default.use(i.default);var l=s.createRouterLayout((function(e){return Promise.resolve().then((function(){return a.__importStar(r("73e9")("./"+e+".vue"))}))})),p=new i.default({mode:"history",routes:[{path:"/",component:l,children:o.default}]});p.beforeEach(function(){var e=n(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=c.default.state.isInited,!a){e.next=4;break}return n(),e.abrupt("return");case 4:if("/signup"!==t.path){e.next=7;break}return n(),e.abrupt("return");case 7:return e.next=9,f.default();case 9:n();case 10:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()),t.default=p},b850:function(e,t,r){"use strict";r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0");var n=r("970b");Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function e(){n(this,e),this.isInited=!1,this.user=null,this.chatting=null,this.groups=[],this.privates=[],this.chatLogs=new Map};e.State=t}(t.store||(t.store={}))},cd49:function(e,t,r){"use strict";r("e260"),r("e6cf"),r("cca6"),r("a79d"),Object.defineProperty(t,"__esModule",{value:!0});var n=r("9ab4"),a=n.__importDefault(r("2b0e")),u=n.__importDefault(r("3dfd")),i=n.__importDefault(r("afbc")),o=n.__importDefault(r("0613"));r("f175"),r("26ba"),r("1440"),r("6f37"),r("1032"),a.default.config.productionTip=!1,new a.default({router:i.default,store:o.default,render:function(e){return e(u.default)}}).$mount("#app")},d153:function(e,t,r){"use strict";r("b0c0");var n=r("970b");Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function e(t,r,a,u){n(this,e),this.id=t,this.name=r,this.password=a,this.topic=u};e.Group=t;var r=function e(t,r,a){n(this,e),this.id=t,this.name=r,this.pubKey=a};e.Private=r}(t.contact||(t.contact={}))},f175:function(e,t,r){"use strict";r("d3b7"),Object.defineProperty(t,"__esModule",{value:!0});var n=r("9ab4"),a=n.__importDefault(r("2b0e")),u=n.__importDefault(r("bc3a")),i={baseURL:"http://check.jiaoyisuo.online/api"},o=u.default.create(i);t.axiosInstance=o,o.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),o.interceptors.response.use((function(e){return e.data}),(function(e){return e}));var s={install:function(){Object.defineProperties(a.default.prototype,{$axios:{get:function(){return o}}})}};a.default.use(s),t.default=s}});
//# sourceMappingURL=app.283a0847.js.map